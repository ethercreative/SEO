{"version":3,"file":"seo-field.min.js","sources":["../../../resources/js/seo-field.js"],"sourcesContent":["/* global Craft, Garnish, $, module, define */\n\nconst SeoField = function (namespace, hasSection) {\n    if (window.hasSeoField) return;\n    \n    window.hasSeoField = true;\n\n    this.namespace = namespace;\n\n    // Field\n    document.getElementById(namespace + '-field').addEventListener('DOMNodeRemoved', function () {\n        window.hasSeoField = false;\n    });\n\n    // Snippet\n    this.title();\n    this.slug();\n    this.desc();\n\n    if (hasSection) {\n\n        this.getHTMLForParsing = new SeoField.GetEntryHTML();\n\n        // Keyword\n        this.keyword = document.getElementById(namespace + '-keyword');\n\n        // Score\n        this.score = document.getElementById(namespace + \"-score\");\n        this.list = document.getElementById(namespace + \"-list\");\n        this.bar = document.getElementById(namespace + \"-bar\");\n        this.scoreField = document.getElementById(namespace + \"-score-field\");\n        this.toggle();\n\n        // Calculate\n        this.calculateScore();\n\n        // Re-calculate the score every second\n        setInterval(() => {\n            this.calculateScore();\n        }, 1000);\n\n    }\n};\n\n// SNIPPET\nSeoField.prototype.title = function () {\n    const title = this.titleField = document.getElementById(this.namespace + '-title')\n        , t = document.getElementById('title');\n    let tInput, titleInput, initial;\n\n    tInput = function () {\n        title.value = this.value + ' ' + initial;\n    };\n\n    titleInput = function () {\n        this.classList.remove('clean');\n        t.removeEventListener('input', tInput, false);\n        this.removeEventListener('input', titleInput, false);\n    };\n\n    if (t && title.classList.contains('clean')) {\n        initial = title.value;\n        t.addEventListener('input', tInput, false);\n    }\n\n    title.addEventListener('input', titleInput, false);\n\n    title.addEventListener('change', () => { this.calculateScore(); });\n};\n\nSeoField.prototype.slug = function () {\n    const slug = this.slugField = document.getElementById(this.namespace + '-slug')\n        , s = document.getElementById('slug');\n\n    if (s && slug) {\n        slug.textContent = s.value;\n\n        // On a loop because crafts slug generation doesn't trigger any events\n        setInterval(() => {\n            if (slug.textContent !== s.value) {\n                slug.textContent = s.value;\n                this.calculateScore();\n            }\n        }, 1000);\n    }\n};\n\nSeoField.prototype.desc = function () {\n    const desc = this.descField = document.getElementById(this.namespace + '-description');\n\n    function adjustHeight () {\n        setTimeout(function () {\n            desc.oninput();\n        }, 1);\n    }\n\n    // Set Initial Height\n    adjustHeight();\n\n    // Set height on tab change (needed if the field is in a separate tab)\n    if (document.getElementById('tabs')) {\n        [].slice.call(document.querySelectorAll('#tabs a.tab')).forEach(function (el) {\n            el.addEventListener('click', function () {\n                adjustHeight();\n            });\n        });\n    }\n\n    if (Craft.livePreview) {\n        Craft.livePreview.on('enter', adjustHeight);\n        Craft.livePreview.on('exit', adjustHeight);\n    }\n    window.addEventListener('resize', adjustHeight);\n\n    // Disable line breaks\n    desc.addEventListener('keydown', function (e) {\n        if (e.keyCode === 13) e.preventDefault();\n    });\n\n    // Cleanse line breaks and check length\n    desc.addEventListener('input', function () {\n        this.value = this.value.replace(/(\\r\\n|\\n|\\r)/gm,\" \");\n        if (this.value.length > 160) this.classList.add('invalid');\n        else this.classList.remove('invalid');\n    });\n\n    desc.addEventListener('change', () => { this.calculateScore(); });\n};\n\n// SCORE\nSeoField.prototype.toggle = function () {\n    let isOpen = false;\n\n    this.score.getElementsByClassName('toggle-score')[0].addEventListener('click', () => {\n        this.score.classList.toggle('open');\n        isOpen = !isOpen;\n\n        if (isOpen) {\n            this.score.getElementsByClassName('details')[0].style.height = this.score.getElementsByClassName('details-inner')[0].clientHeight + 'px';\n        } else {\n            this.score.getElementsByClassName('details')[0].style.height = '';\n        }\n    });\n\n    this.toggle.close = () => {\n        this.score.classList.remove('open');\n        isOpen = false;\n        this.score.getElementsByClassName('details')[0].style.height = '';\n    };\n};\n\nSeoField.prototype.calculateScore = function () {\n    if (this.keyword && this.keyword.value) {\n        this.currentScore = {};\n\n        this.currentScore.titleLength = this.judgeTitleLength();\n        this.currentScore.titleKeyword = this.judgeTitleKeyword();\n        this.currentScore.slug = this.judgeSlug();\n        this.currentScore.desc = this.judgeDesc();\n\n        this.getHTMLForParsing.update((content) => {\n            if (content.textContent.replace('\\r', '').replace('\\n', '').replace('\\r\\n', '').replace(/\\s+/gi, '') === '') {\n                this.currentScore.noContent = {\n                    score: SeoField.Levels.BAD,\n                    reason: 'You have no content, adding some would be a good start!'\n                };\n            } else {\n                this.content = content;\n                this.content.textOnly = this.content.textContent.replace('\\r', ' ').replace('\\n', ' ').replace('\\r\\n', ' ').replace(/\\s+/gi, ' ');\n                this.content.stats = SeoField.TextStatistics(this.content.textContent);\n\n                this.currentScore.wordCount = this.judgeWordCount();\n                this.currentScore.firstParagraph = this.judgeFirstParagraph();\n                this.currentScore.images = this.judgeImages();\n                this.currentScore.links = this.judgeLinks();\n                this.currentScore.headings = this.judgeHeadings();\n                this.currentScore.density = this.judgeDensity();\n                this.currentScore.fleschEase = this.judgeFleschEase();\n            }\n\n            this.getHTMLForParsing.clean();\n            this.updateScoreHtml();\n        });\n    } else {\n        this.toggle.close();\n        this.score.classList.add('disabled');\n        this.scoreField.value = '';\n    }\n};\n\nSeoField.prototype.updateScoreHtml = function () {\n    this.score.classList.remove('disabled');\n\n    const sorted = SeoField.sortScore(this.currentScore);\n    const sortedScore = sorted.merged;\n\n    this.list.innerHTML = '';\n    for (let i = 0; i < sortedScore.length; i++) {\n        const j = sortedScore[i];\n        this.list.innerHTML += '<li class=\"'+ j.score+'\">' + j.reason + '</li>';\n    }\n\n    const good = this.bar.getElementsByClassName('good')[0]\n        , ok = this.bar.getElementsByClassName('ok')[0]\n        , bad = this.bar.getElementsByClassName('bad')[0];\n\n    const goodW = 1 - ((sortedScore.length - sorted.good.length) / sortedScore.length)\n        , okW = 1 - ((sortedScore.length - sorted.ok.length) / sortedScore.length)\n        , badW = 1 - ((sortedScore.length - sorted.bad.length) / sortedScore.length);\n\n    good.style.transform = 'scale(' + goodW + ', 1)';\n    ok.style.transform = 'translateX(' + (goodW * 100) + '%) scale(' + okW + ', 1)';\n    bad.style.transform = 'translateX(' + ((goodW + okW) * 100) + '%) scale(' + badW + ', 1)';\n\n    let s = '';\n\n    if (badW > goodW) {\n        s = 'bad';\n    } else if ((badW + okW) > goodW) {\n        s = 'ok';\n    } else {\n        s = 'good';\n    }\n\n    this.scoreField.value = s;\n};\n\n// CALCULATOR\nSeoField.prototype.judgeTitleLength = function () {\n    const v = this.titleField.value;\n    \n    let ret = {\n        score : (v.length < 40 || v.length > 60) ? SeoField.Levels.BAD : SeoField.Levels.GOOD,\n        reason: (v.length < 40) ? SeoField.Reasons.titleLengthFailMin : (v.length > 60) ? SeoField.Reasons.titleLengthFailMax : SeoField.Reasons.titleLengthSuccess\n    };\n    ret.reason = ret.reason.replace('{l}', v.length);\n\n    return ret;\n};\n\nSeoField.prototype.judgeTitleKeyword = function () {\n    let ret;\n    const index = this.titleField.value.toLowerCase().indexOf(this.keyword.value.toLowerCase());\n\n    if (index > -1) {\n        if (index <= this.titleField.value.length * 0.3) {\n            ret = {\n                score : SeoField.Levels.GOOD,\n                reason: SeoField.Reasons.titleKeywordSuccess\n            };\n        } else {\n            ret = {\n                score : SeoField.Levels.OK,\n                reason: SeoField.Reasons.titleKeywordPosFail\n            };\n        }\n    } else {\n        ret = {\n            score : SeoField.Levels.BAD,\n            reason: SeoField.Reasons.titleKeywordFail\n        };\n    }\n\n    return ret;\n};\n\nSeoField.prototype.judgeSlug = function () {\n    if (!this.slugField) return;\n\n    if (this.slugField.textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase().replace(/[^a-zA-Z0-9-_]/g, '')) > -1) {\n        return {\n            score : SeoField.Levels.GOOD,\n            reason: SeoField.Reasons.slugSuccess\n        };\n    } else {\n        return {\n            score : SeoField.Levels.BAD,\n            reason: SeoField.Reasons.slugFail\n        };\n    }\n};\n\n// TODO: Check if keyword in first half / number of times it appears?\nSeoField.prototype.judgeDesc = function () {\n    if (this.descField.value.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n        return {\n            score : SeoField.Levels.GOOD,\n            reason: SeoField.Reasons.descSuccess\n        };\n    } else {\n        return {\n            score : SeoField.Levels.BAD,\n            reason: SeoField.Reasons.descFail\n        };\n    }\n};\n\nSeoField.prototype.judgeWordCount = function () {\n    var wc = this.content.stats.wordCount();\n    if (wc > 300) {\n        return {\n            score : SeoField.Levels.GOOD,\n            reason: SeoField.Reasons.wordCountSuccess.replace('{l}', wc)\n        };\n    } else {\n        return {\n            score : SeoField.Levels.BAD,\n            reason: SeoField.Reasons.wordCountFail.replace('{l}', wc)\n        };\n    }\n};\n\nSeoField.prototype.judgeFirstParagraph = function () {\n    if (this.content.querySelector('p') && this.content.querySelector('p').textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n        return {\n            score : SeoField.Levels.GOOD,\n            reason: SeoField.Reasons.firstParagraphSuccess\n        };\n    } else {\n        return {\n            score : SeoField.Levels.BAD,\n            reason: SeoField.Reasons.firstParagraphFail\n        };\n    }\n};\n\nSeoField.prototype.judgeImages = function () {\n    const imgs = this.content.getElementsByTagName('img');\n    if (imgs) {\n        let imgsWithAltKeyword = 0;\n\n        for (let i = 0; i < imgs.length; i++) {\n            if (imgs[i].getAttribute('alt') &&\n                imgs[i].getAttribute('alt').toLowerCase().indexOf(this.keyword.value.toLowerCase()))\n                imgsWithAltKeyword++;\n        }\n\n        if (imgsWithAltKeyword === imgs.length) {\n            return {\n                score : SeoField.Levels.GOOD,\n                reason: SeoField.Reasons.imagesSuccess\n            };\n        } else if (imgsWithAltKeyword >= imgs.length/2) {\n            return {\n                score : SeoField.Levels.OK,\n                reason: SeoField.Reasons.imagesOk\n            };\n        } else {\n            return {\n                score : SeoField.Levels.BAD,\n                reason: SeoField.Reasons.imagesFail\n            };\n        }\n    }\n};\n\nSeoField.prototype.judgeLinks = function () {\n    const a = this.content.getElementsByTagName('a');\n\n    if (a) {\n        for (let i = 0; i < a.length; i++) {\n            if (SeoField.isExternalUrl(a[i].href)) {\n                return {\n                    score : SeoField.Levels.GOOD,\n                    reason: SeoField.Reasons.linksSuccess\n                };\n            }\n        }\n    }\n\n    return {\n        score : SeoField.Levels.BAD,\n        reason: SeoField.Reasons.linksFail\n    };\n};\n\nSeoField.prototype.judgeHeadings = function () {\n    const headings = this.content.querySelectorAll('h1,h2,h3,h4,h5,h6');\n\n    if (headings) {\n        let primary = 0, secondary = 0;\n\n        for (let i = 0; i < headings.length; i++) {\n            if (headings[i].textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase()) > -1) {\n                if (['H1', 'H2'].indexOf(headings[i].nodeName) > -1) {\n                    primary++;\n                } else {\n                    secondary++;\n                }\n            }\n        }\n\n        if (primary > 0) {\n            return {\n                score : SeoField.Levels.GOOD,\n                reason: SeoField.Reasons.headingsSuccess\n            };\n        } else if (secondary > 0) {\n            return {\n                score : SeoField.Levels.OK,\n                reason: SeoField.Reasons.headingsOk\n            };\n        }\n    }\n\n    return {\n        score : SeoField.Levels.BAD,\n        reason: SeoField.Reasons.headingsFail\n    };\n};\n\nSeoField.prototype.judgeDensity = function () {\n    const words = this.content.stats.words();\n\n    function countInArray (arr, word) {\n        let c = 0, i = 0;\n        for (; i < arr.length; i++)\n            if (arr[i].toLowerCase() === word) c++;\n        return c;\n    }\n\n    const keyCount = countInArray(words, this.keyword.value.toLowerCase());\n\n    const keyPercent = parseFloat((100 + ((keyCount - words.length) / words.length) * 100).toFixed(2));\n\n    if (keyPercent < 1.0) {\n        return {\n            score : SeoField.Levels.BAD,\n            reason: SeoField.Reasons.densityFailUnder.replace('{d}', keyPercent)\n        };\n    } else if (keyPercent <= 2.5) {\n        return {\n            score : SeoField.Levels.GOOD,\n            reason: SeoField.Reasons.densitySuccess.replace('{d}', keyPercent)\n        };\n    } else if (keyPercent > 2.5) {\n        return {\n            score : SeoField.Levels.OK,\n            reason: SeoField.Reasons.densityOk.replace('{d}', keyPercent).replace('{c}', keyCount)\n        };\n    }\n\n    return {\n        score : SeoField.Levels.BAD,\n        reason: SeoField.Reasons.densityFail\n    };\n};\n\nSeoField.prototype.judgeFleschEase = function () {\n    const level = this.content.stats.fleschKincaidReadingEase();\n\n    if (level >= 80) {\n        return {\n            score : SeoField.Levels.GOOD,\n            reason: SeoField.Reasons.fleschSuccess.replace('{l}', level)\n        };\n    } else if (level >= 60) {\n        return {\n            score : SeoField.Levels.OK,\n            reason: SeoField.Reasons.fleschOk.replace('{l}', level)\n        };\n    }\n\n    return {\n        score : SeoField.Levels.BAD,\n        reason: SeoField.Reasons.fleschFail.replace('{l}', level)\n    };\n};\n\n// HELPERS\nSeoField.Fail = function (message) {\n    Craft.cp.displayError('<strong>SEO:</strong> ' + message);\n    if (window.console) console.error.apply(console, ['%cSEO: %c' + message, 'font-weight:bold;','font-weight:normal;']); // eslint-disable-line no-console\n};\n\n/**\n * Get Parsed Fields HTML\n */\nSeoField.GetEntryHTML = function () {\n    this.clean();\n};\n\nSeoField.GetEntryHTML.prototype.update = function (cb) {\n    const postData = Garnish.getPostData(document.getElementById('container'));\n\n    if (typeof Craft.livePreview === typeof undefined) {\n        this.score.previousElementSibling.classList.add('hide');\n        return;\n    }\n\n    if (!this.lastPostData || !Craft.compare(postData, this.lastPostData)) {\n        this.lastPostData = postData;\n\n        $.ajax({\n            url: Craft.livePreview.previewUrl,\n            method: 'POST',\n            data: $.extend({}, postData, Craft.livePreview.basePostData),\n            xhrFields: {\n                withCredentials: true\n            },\n            crossDomain: true,\n            success: (data) => {\n                data = data.replace(/<script([^'\"]|\"(\\\\.|[^\"\\\\])*\"|'(\\\\.|[^'\\\\])*')*?<\\/script>/g, '');\n\n                this.iframe.contentWindow.document.open();\n                this.iframe.contentWindow.document.write(data);\n                this.iframe.contentWindow.document.close();\n\n                if (this.iframe.contentWindow.document.body)\n                    cb(this.iframe.contentWindow.document.body);\n                else\n                    SeoField.Fail(\"Unable to calculate score\");\n            }\n        });\n    }\n};\n\nSeoField.GetEntryHTML.prototype.clean = function () {\n    if (this.iframe)\n        document.body.removeChild(this.iframe);\n\n    this.iframe = document.createElement('iframe');\n    this.iframe.setAttribute('frameborder', '0');\n    this.iframe.style.width = '0px';\n    this.iframe.style.height = '0px';\n    document.body.appendChild(this.iframe);\n};\n\n/**\n * External URL checker\n * From http://stackoverflow.com/a/9744104/550109\n *\n * @param {string} url\n */\nSeoField.isExternalUrl = (function(){\n    const domainRe = /https?:\\/\\/((?:[\\w\\d]+\\.)+[\\w\\d]{2,})/i;\n    let res = null;\n\n    return function(url) {\n        function domain(url) {\n            return (res = domainRe.exec(url)) !== null ? res[1] : false;\n        }\n\n        return domain(location.href) !== domain(url);\n    };\n})();\n\n/**\n * Organize the judgements by score\n *\n * @param unsorted\n * @returns {{good: Array, ok: Array, bad: Array, merged: Array.<T>}}\n */\nSeoField.sortScore = function (unsorted) {\n    const good = [], ok = [], bad = [];\n    for (let key in unsorted) {\n        if (unsorted.hasOwnProperty(key) && unsorted[key]) {\n            unsorted[key].key = key;\n            switch (unsorted[key].score) {\n                case SeoField.Levels.BAD:\n                    bad.push(unsorted[key]);\n                    break;\n                case SeoField.Levels.OK:\n                    ok.push(unsorted[key]);\n                    break;\n                case SeoField.Levels.GOOD:\n                    good.push(unsorted[key]);\n                    break;\n            }\n        }\n    }\n\n    return {\n        good: good,\n        ok: ok,\n        bad: bad,\n        merged: good.concat(ok.concat(bad))\n    };\n};\n\n/**\n * TextStatistics.js\n * Christopher Giffard (2012)\n * 1:1 API Fork of TextStatistics.php by Dave Child (Thanks mate!)\n * https://github.com/DaveChild/Text-Statistics\n *\n * Modified by Tam<hi@tam.sx>\n */\n(function(glob) {\n\n    function cleanText(text) {\n        // all these tags should be preceeded by a full stop.\n        const fullStopTags = ['li', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'dd'];\n\n        fullStopTags.forEach(function(tag) {\n            text = text.replace(\"</\" + tag + \">\",\".\");\n        });\n\n        text = text\n            .replace(/<[^>]+>/g, \"\")                // Strip tags\n            .replace(/[,:;()-]/, \" \")                // Replace commas, hyphens etc (count them as spaces)\n            .replace(/’/g, \"'\")                     // Replace ’ with '\n            .replace(/[\\.!?]/, \".\")                    // Unify terminators\n            .replace(/^\\s+/,\"\")                        // Strip leading whitespace\n            .replace(/[ ]*(\\n|\\r\\n|\\r)[ ]*/,\" \")    // Replace new lines with spaces\n            .replace(/([\\.])[\\. ]+/,\".\")            // Check for duplicated terminators\n            .replace(/[ ]*([\\.])/,\". \")                // Pad sentence terminators\n            .replace(/\\s+/,\" \")                        // Remove multiple spaces\n            .replace(/\\s+$/,\"\");                    // Strip trailing whitespace\n\n        text += \".\"; // Add final terminator, just in case it's missing.\n\n        return text;\n    }\n\n    const TextStatistics = function TextStatistics(text) {\n        this.text = text ? cleanText(text) : this.text;\n    };\n\n    TextStatistics.prototype.fleschKincaidReadingEase = function(text) {\n        text = text ? cleanText(text) : this.text;\n        return Math.round((206.835 - (1.015 * this.averageWordsPerSentence(text)) - (84.6 * this.averageSyllablesPerWord(text)))*10)/10;\n    };\n\n    TextStatistics.prototype.fleschKincaidGradeLevel = function(text) {\n        text = text ? cleanText(text) : this.text;\n        return Math.round(((0.39 * this.averageWordsPerSentence(text)) + (11.8 * this.averageSyllablesPerWord(text)) - 15.59)*10)/10;\n    };\n\n    TextStatistics.prototype.gunningFogScore = function(text) {\n        text = text ? cleanText(text) : this.text;\n        return Math.round(((this.averageWordsPerSentence(text) + this.percentageWordsWithThreeSyllables(text, false)) * 0.4)*10)/10;\n    };\n\n    TextStatistics.prototype.colemanLiauIndex = function(text) {\n        text = text ? cleanText(text) : this.text;\n        return Math.round(((5.89 * (this.letterCount(text) / this.wordCount(text))) - (0.3 * (this.sentenceCount(text) / this.wordCount(text))) - 15.8 ) *10)/10;\n    };\n\n    TextStatistics.prototype.smogIndex = function(text) {\n        text = text ? cleanText(text) : this.text;\n        return Math.round(1.043 * Math.sqrt((this.wordsWithThreeSyllables(text) * (30 / this.sentenceCount(text))) + 3.1291)*10)/10;\n    };\n\n    TextStatistics.prototype.automatedReadabilityIndex = function(text) {\n        text = text ? cleanText(text) : this.text;\n        return Math.round(((4.71 * (this.letterCount(text) / this.wordCount(text))) + (0.5 * (this.wordCount(text) / this.sentenceCount(text))) - 21.43)*10)/10;\n    };\n\n    TextStatistics.prototype.textLength = function(text) {\n        text = text ? cleanText(text) : this.text;\n        return text.length;\n    };\n\n    TextStatistics.prototype.letterCount = function(text) {\n        text = text ? cleanText(text) : this.text;\n        text = text.replace(/[^a-z]+/ig,\"\");\n        return text.length;\n    };\n\n    TextStatistics.prototype.sentenceCount = function(text) {\n        text = text ? cleanText(text) : this.text;\n\n        // Will be tripped up by \"Mr.\" or \"U.K.\". Not a major concern at this point.\n        return text.replace(/[^\\.!?]/g, '').length || 1;\n    };\n\n    TextStatistics.prototype.wordCount = function(text) {\n        text = text ? cleanText(text) : this.text;\n        return text.split(/[^a-z0-9']+/i).length || 1;\n    };\n\n    TextStatistics.prototype.words = function () {\n        if (this._words) return this._words;\n        return this._words = this.text.split(/[^a-z0-9']+/i); // jshint ignore:line\n    };\n\n    TextStatistics.prototype.averageWordsPerSentence = function(text) {\n        text = text ? cleanText(text) : this.text;\n        return this.wordCount(text) / this.sentenceCount(text);\n    };\n\n    TextStatistics.prototype.averageSyllablesPerWord = function(text) {\n        text = text ? cleanText(text) : this.text;\n        let syllableCount = 0, wordCount = this.wordCount(text);\n\n        text.split(/\\s+/).forEach((word) => {\n            syllableCount += this.syllableCount(word);\n        });\n\n        // Prevent NaN...\n        return (syllableCount||1) / (wordCount||1);\n    };\n\n    TextStatistics.prototype.wordsWithThreeSyllables = function(text, countProperNouns) {\n        text = text ? cleanText(text) : this.text;\n        let longWordCount = 0;\n\n        countProperNouns = countProperNouns !== false;\n\n        text.split(/\\s+/).forEach((word) => {\n\n            // We don't count proper nouns or capitalised words if the countProperNouns attribute is set.\n            // Defaults to true.\n            if (!word.match(/^[A-Z]/) || countProperNouns) {\n                if (this.syllableCount(word) > 2) longWordCount ++;\n            }\n        });\n\n        return longWordCount;\n    };\n\n    TextStatistics.prototype.percentageWordsWithThreeSyllables = function(text, countProperNouns) {\n        text = text ? cleanText(text) : this.text;\n\n        return (this.wordsWithThreeSyllables(text,countProperNouns) / this.wordCount(text)) * 100;\n    };\n\n    TextStatistics.prototype.syllableCount = function(word) {\n        let syllableCount = 0,\n            prefixSuffixCount = 0,\n            wordPartCount = 0;\n\n        // Prepare word - make lower case and remove non-word characters\n        word = word.toLowerCase().replace(/[^a-z]/g,\"\");\n\n        // Specific common exceptions that don't follow the rule set below are handled individually\n        // Array of problem words (with word as key, syllable count as value)\n        const problemWords = {\n            \"simile\":        3,\n            \"forever\":        3,\n            \"shoreline\":    2\n        };\n\n        // Return if we've hit one of those...\n        if (problemWords.hasOwnProperty(word)) return problemWords[word];\n\n        // These syllables would be counted as two but should be one\n        const subSyllables = [\n            /cial/,\n            /tia/,\n            /cius/,\n            /cious/,\n            /giu/,\n            /ion/,\n            /iou/,\n            /sia$/,\n            /[^aeiuoyt]{2,}ed$/,\n            /.ely$/,\n            /[cg]h?e[rsd]?$/,\n            /rved?$/,\n            /[aeiouy][dt]es?$/,\n            /[aeiouy][^aeiouydt]e[rsd]?$/,\n            /^[dr]e[aeiou][^aeiou]+$/, // Sorts out deal, deign etc\n            /[aeiouy]rse$/ // Purse, hearse\n        ];\n\n        // These syllables would be counted as one but should be two\n        const addSyllables = [\n            /ia/,\n            /riet/,\n            /dien/,\n            /iu/,\n            /io/,\n            /ii/,\n            /[aeiouym]bl$/,\n            /[aeiou]{3}/,\n            /^mc/,\n            /ism$/,\n            /([^aeiouy])\\1l$/,\n            /[^l]lien/,\n            /^coa[dglx]./,\n            /[^gq]ua[^auieo]/,\n            /dnt$/,\n            /uity$/,\n            /ie(r|st)$/\n        ];\n\n        // Single syllable prefixes and suffixes\n        const prefixSuffix = [\n            /^un/,\n            /^fore/,\n            /ly$/,\n            /less$/,\n            /ful$/,\n            /ers?$/,\n            /ings?$/\n        ];\n\n        // Remove prefixes and suffixes and count how many were taken\n        prefixSuffix.forEach(function(regex) {\n            if (word.match(regex)) {\n                word = word.replace(regex,\"\");\n                prefixSuffixCount ++;\n            }\n        });\n\n        wordPartCount = word\n            .split(/[^aeiouy]+/ig)\n            .filter(function(wordPart) {\n                return !!wordPart.replace(/\\s+/ig,\"\").length;\n            })\n            .length;\n\n        // Get preliminary syllable count...\n        syllableCount = wordPartCount + prefixSuffixCount;\n\n        // Some syllables do not follow normal rules - check for them\n        subSyllables.forEach(function(syllable) {\n            if (word.match(syllable)) syllableCount --;\n        });\n\n        addSyllables.forEach(function(syllable) {\n            if (word.match(syllable)) syllableCount ++;\n        });\n\n        return syllableCount || 1;\n    };\n\n    function textStatistics(text) {\n        return new TextStatistics(text);\n    }\n\n    (typeof module != \"undefined\" && module.exports) ? (module.exports = textStatistics) : (typeof define != \"undefined\" ? (define(\"textstatistics\", [], function() { return textStatistics; })) : (glob.TextStatistics = textStatistics)); // jshint ignore:line\n})(SeoField);\n\n// CONSTS / ENUMS\nSeoField.Levels = {\n    NONE: '',\n    GOOD: 'good',\n    OK: 'ok',\n    BAD: 'bad'\n};\n\nSeoField.Reasons = {\n    titleLengthFailMin: 'The title contains {l} characters which is less than the recommended minimum of 40 characters.',\n    titleLengthFailMax: 'The title contains {l} characters which is greater than the recommended maximum of 60 characters.',\n    titleLengthSuccess: 'The title is between the recommended minimum and maximum length.',\n\n    titleKeywordFail: 'The title does not contain the keyword. Try adding it near the beginning of the title.',\n    titleKeywordSuccess: 'The title contains the keyword near the beginning.',\n    titleKeywordPosFail: 'The title contains the keyword, but not near the beginning. Try to move it closer to the start of the title.',\n\n    slugFail: 'The URL does not contain the keyword. Try adding it to the slug.',\n    slugSuccess: 'The URL contains the keyword.',\n\n    descFail: 'The description does not contain the keyword. Try adding it near the beginning of the description.',\n    descSuccess: 'The description contains the keyword.',\n\n    wordCountFail: 'Your text contains {l} words, this is less than the recommended 300 word minimum.',\n    wordCountSuccess: 'Your text contains {l} words, this is more than the recommended 300 word minimum.',\n\n    firstParagraphFail: 'The keyword does not appear in the first paragraph of your text. Try adding it.',\n    firstParagraphSuccess: 'The keyword appears in the first paragraph of your text.',\n\n    imagesFail: 'Less than half of the images have alt tags containing the keyword, try adding it to more images.',\n    imagesOk: 'Half or more of the images have alt tags containing the keyword. To improve this, try adding keywords to all the images alt tags.',\n    imagesSuccess: 'All of the images have alt tags containing the keyword.',\n\n    linksFail: 'The page does not contain any outgoing links. Try adding some.',\n    linksSuccess: 'The page contains outgoing links.',\n\n    headingsFail: 'The page does not contain any headings that contain the keyword. Try adding some with the keyword.',\n    headingsOk: 'The page contains some lower importance headings that contain the keyword. Try adding the keyword to some h2\\'s.',\n    headingsSuccess: 'The page contains higher importance headings with the keyword.',\n\n    densityFail: 'The keyword does not appear in the text. It is important to include it in your content.',\n    densityFailUnder: 'The keyword density is {d}%, which is well under the advised 2.5%. Try increasing the number of times the keyword is used.',\n    densityOk: 'The keyword density is {d}%, which is over the advised 2.5%. The keyword appears {c} times.',\n    densitySuccess: 'The keyword density is {d}%, which is near the advised 2.5%.',\n\n    fleschFail: 'The Flesch Reading ease score is {l} which is considered best for university graduates. Try reducing your sentence length to improve readability.',\n    fleschOk: 'The Flesch Reading ease score is {l} which is average, and considered easily readable by most users.',\n    fleschSuccess: 'The Flesch Reading ease score is {l} meaning your content is readable by all ages.',\n};\n"],"names":["SeoField","namespace","hasSection","window","hasSeoField","getElementById","addEventListener","title","slug","desc","getHTMLForParsing","GetEntryHTML","keyword","document","score","list","bar","scoreField","toggle","calculateScore","prototype","this","titleField","t","tInput","titleInput","initial","value","classList","remove","removeEventListener","contains","slugField","s","textContent","descField","adjustHeight","oninput","slice","call","querySelectorAll","forEach","el","Craft","livePreview","on","e","keyCode","preventDefault","replace","length","add","isOpen","getElementsByClassName","style","height","_this5","clientHeight","close","currentScore","titleLength","judgeTitleLength","titleKeyword","judgeTitleKeyword","judgeSlug","judgeDesc","update","content","noContent","Levels","BAD","textOnly","_this6","stats","TextStatistics","wordCount","judgeWordCount","firstParagraph","judgeFirstParagraph","images","judgeImages","links","judgeLinks","headings","judgeHeadings","density","judgeDensity","fleschEase","judgeFleschEase","clean","updateScoreHtml","sorted","sortScore","sortedScore","merged","innerHTML","i","j","reason","good","ok","bad","goodW","okW","badW","transform","v","ret","GOOD","Reasons","titleLengthFailMin","titleLengthFailMax","titleLengthSuccess","index","toLowerCase","indexOf","titleKeywordSuccess","OK","titleKeywordPosFail","titleKeywordFail","slugSuccess","slugFail","descSuccess","descFail","wc","wordCountSuccess","wordCountFail","querySelector","firstParagraphSuccess","firstParagraphFail","imgs","getElementsByTagName","imgsWithAltKeyword","getAttribute","imagesSuccess","imagesOk","imagesFail","a","isExternalUrl","href","linksSuccess","linksFail","primary","secondary","nodeName","headingsSuccess","headingsOk","headingsFail","words","keyCount","arr","word","c","countInArray","keyPercent","parseFloat","toFixed","densityFailUnder","densitySuccess","densityOk","densityFail","level","fleschKincaidReadingEase","fleschSuccess","fleschOk","fleschFail","Fail","message","cp","displayError","console","error","apply","cb","postData","Garnish","getPostData","babelHelpers.typeof","lastPostData","compare","ajax","previewUrl","$","extend","basePostData","data","iframe","contentWindow","open","write","_this7","body","previousElementSibling","removeChild","createElement","setAttribute","width","appendChild","domainRe","res","url","domain","exec","location","unsorted","key","hasOwnProperty","push","concat","glob","cleanText","text","tag","Math","round","averageWordsPerSentence","averageSyllablesPerWord","fleschKincaidGradeLevel","gunningFogScore","percentageWordsWithThreeSyllables","colemanLiauIndex","letterCount","sentenceCount","smogIndex","sqrt","wordsWithThreeSyllables","automatedReadabilityIndex","textLength","split","_words","syllableCount","_this8","countProperNouns","longWordCount","match","_this9","prefixSuffixCount","wordPartCount","problemWords","regex","filter","wordPart","syllable","textStatistics","module","exports","define"],"mappings":"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"}