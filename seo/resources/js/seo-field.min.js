var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},SeoField=function e(t,o){var n=this;window.hasSeoField||(window.hasSeoField=!0,this.namespace=t,document.getElementById(t+"-field").addEventListener("DOMNodeRemoved",function(){window.hasSeoField=!1}),this.title(),this.slug(),this.desc(),o&&(this.getHTMLForParsing=new e.GetEntryHTML,this.keyword=document.getElementById(t+"-keyword"),this.score=document.getElementById(t+"-score"),this.list=document.getElementById(t+"-list"),this.bar=document.getElementById(t+"-bar"),this.scoreField=document.getElementById(t+"-score-field"),this.toggle(),this.calculateScore(),setInterval(function(){n.calculateScore()},1e3)))};SeoField.prototype.title=function(){var e=this,t=this.titleField=document.getElementById(this.namespace+"-title"),o=document.getElementById("title"),n=void 0,s=void 0,i=void 0;n=function(){t.value=this.value+" "+i},s=function(){this.classList.remove("clean"),o.removeEventListener("input",n,!1),this.removeEventListener("input",s,!1)},o&&t.classList.contains("clean")&&(i=t.value,o.addEventListener("input",n,!1)),t.addEventListener("input",s,!1),t.addEventListener("change",function(){e.calculateScore()})},SeoField.prototype.slug=function(){var e=this,t=this.slugField=document.getElementById(this.namespace+"-slug"),o=document.getElementById("slug");o&&t&&(t.textContent=o.value,setInterval(function(){t.textContent!==o.value&&(t.textContent=o.value,e.calculateScore())},1e3))},SeoField.prototype.desc=function(){var e=this,t=this.descField=document.getElementById(this.namespace+"-description");function o(){setTimeout(function(){t.oninput()},1)}o(),document.getElementById("tabs")&&[].slice.call(document.querySelectorAll("#tabs a.tab")).forEach(function(e){e.addEventListener("click",function(){o()})}),Craft.livePreview&&(Craft.livePreview.on("enter",o),Craft.livePreview.on("exit",o)),window.addEventListener("resize",o),t.addEventListener("keydown",function(e){13===e.keyCode&&e.preventDefault()}),t.addEventListener("input",function(){this.value=this.value.replace(/(\r\n|\n|\r)/gm," "),this.value.length>160?this.classList.add("invalid"):this.classList.remove("invalid")}),t.addEventListener("change",function(){e.calculateScore()})},SeoField.prototype.toggle=function(){var e=this,t=!1;this.score.getElementsByClassName("toggle-score")[0].addEventListener("click",function(){e.score.classList.toggle("open"),t=!t,e.score.getElementsByClassName("details")[0].style.height=t?e.score.getElementsByClassName("details-inner")[0].clientHeight+"px":""}),this.toggle.close=function(){e.score.classList.remove("open"),t=!1,e.score.getElementsByClassName("details")[0].style.height=""}},SeoField.prototype.calculateScore=function(){var e=this;this.keyword&&this.keyword.value?(this.currentScore={},this.currentScore.titleLength=this.judgeTitleLength(),this.currentScore.titleKeyword=this.judgeTitleKeyword(),this.currentScore.slug=this.judgeSlug(),this.currentScore.desc=this.judgeDesc(),this.getHTMLForParsing.update(function(t){""===t.textContent.replace("\r","").replace("\n","").replace("\r\n","").replace(/\s+/gi,"")?e.currentScore.noContent={score:SeoField.Levels.BAD,reason:"You have no content, adding some would be a good start!"}:(e.content=t,e.content.textOnly=e.content.textContent.replace("\r"," ").replace("\n"," ").replace("\r\n"," ").replace(/\s+/gi," "),e.content.stats=SeoField.TextStatistics(e.content.textContent),e.currentScore.wordCount=e.judgeWordCount(),e.currentScore.firstParagraph=e.judgeFirstParagraph(),e.currentScore.images=e.judgeImages(),e.currentScore.links=e.judgeLinks(),e.currentScore.headings=e.judgeHeadings(),e.currentScore.density=e.judgeDensity(),e.currentScore.fleschEase=e.judgeFleschEase()),e.getHTMLForParsing.clean(),e.updateScoreHtml()})):(this.toggle.close(),this.score.classList.add("disabled"),this.scoreField.value="")},SeoField.prototype.updateScoreHtml=function(){this.score.classList.remove("disabled");var e=SeoField.sortScore(this.currentScore),t=e.merged;this.list.innerHTML="";for(var o=0;o<t.length;o++){var n=t[o];this.list.innerHTML+='<li class="'+n.score+'">'+n.reason+"</li>"}var s=this.bar.getElementsByClassName("good")[0],i=this.bar.getElementsByClassName("ok")[0],r=this.bar.getElementsByClassName("bad")[0],a=1-(t.length-e.good.length)/t.length,l=1-(t.length-e.ok.length)/t.length,d=1-(t.length-e.bad.length)/t.length;s.style.transform="scale("+a+", 1)",i.style.transform="translateX("+100*a+"%) scale("+l+", 1)",r.style.transform="translateX("+100*(a+l)+"%) scale("+d+", 1)";var c="";c=d>a?"bad":d+l>a?"ok":"good",this.scoreField.value=c},SeoField.prototype.judgeTitleLength=function(){var e=this.titleField.value,t={score:e.length<40||e.length>60?SeoField.Levels.BAD:SeoField.Levels.GOOD,reason:e.length<40?SeoField.Reasons.titleLengthFailMin:e.length>60?SeoField.Reasons.titleLengthFailMax:SeoField.Reasons.titleLengthSuccess};return t.reason=t.reason.replace("{l}",e.length),t},SeoField.prototype.judgeTitleKeyword=function(){var e=this.titleField.value.toLowerCase().indexOf(this.keyword.value.toLowerCase());return e>-1?e<=.3*this.titleField.value.length?{score:SeoField.Levels.GOOD,reason:SeoField.Reasons.titleKeywordSuccess}:{score:SeoField.Levels.OK,reason:SeoField.Reasons.titleKeywordPosFail}:{score:SeoField.Levels.BAD,reason:SeoField.Reasons.titleKeywordFail}},SeoField.prototype.judgeSlug=function(){if(this.slugField)return this.slugField.textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase().replace(/[^a-zA-Z0-9-_]/g,""))>-1?{score:SeoField.Levels.GOOD,reason:SeoField.Reasons.slugSuccess}:{score:SeoField.Levels.BAD,reason:SeoField.Reasons.slugFail}},SeoField.prototype.judgeDesc=function(){return this.descField.value.toLowerCase().indexOf(this.keyword.value.toLowerCase())>-1?{score:SeoField.Levels.GOOD,reason:SeoField.Reasons.descSuccess}:{score:SeoField.Levels.BAD,reason:SeoField.Reasons.descFail}},SeoField.prototype.judgeWordCount=function(){var e=this.content.stats.wordCount();return e>300?{score:SeoField.Levels.GOOD,reason:SeoField.Reasons.wordCountSuccess.replace("{l}",e)}:{score:SeoField.Levels.BAD,reason:SeoField.Reasons.wordCountFail.replace("{l}",e)}},SeoField.prototype.judgeFirstParagraph=function(){return this.content.querySelector("p")&&this.content.querySelector("p").textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase())>-1?{score:SeoField.Levels.GOOD,reason:SeoField.Reasons.firstParagraphSuccess}:{score:SeoField.Levels.BAD,reason:SeoField.Reasons.firstParagraphFail}},SeoField.prototype.judgeImages=function(){var e=this.content.getElementsByTagName("img");if(e){for(var t=0,o=0;o<e.length;o++)e[o].getAttribute("alt")&&e[o].getAttribute("alt").toLowerCase().indexOf(this.keyword.value.toLowerCase())&&t++;return t===e.length?{score:SeoField.Levels.GOOD,reason:SeoField.Reasons.imagesSuccess}:t>=e.length/2?{score:SeoField.Levels.OK,reason:SeoField.Reasons.imagesOk}:{score:SeoField.Levels.BAD,reason:SeoField.Reasons.imagesFail}}},SeoField.prototype.judgeLinks=function(){var e=this.content.getElementsByTagName("a");if(e)for(var t=0;t<e.length;t++)if(SeoField.isExternalUrl(e[t].href))return{score:SeoField.Levels.GOOD,reason:SeoField.Reasons.linksSuccess};return{score:SeoField.Levels.BAD,reason:SeoField.Reasons.linksFail}},SeoField.prototype.judgeHeadings=function(){var e=this.content.querySelectorAll("h1,h2,h3,h4,h5,h6");if(e){for(var t=0,o=0,n=0;n<e.length;n++)e[n].textContent.toLowerCase().indexOf(this.keyword.value.toLowerCase())>-1&&(["H1","H2"].indexOf(e[n].nodeName)>-1?t++:o++);if(t>0)return{score:SeoField.Levels.GOOD,reason:SeoField.Reasons.headingsSuccess};if(o>0)return{score:SeoField.Levels.OK,reason:SeoField.Reasons.headingsOk}}return{score:SeoField.Levels.BAD,reason:SeoField.Reasons.headingsFail}},SeoField.prototype.judgeDensity=function(){var e=this.content.stats.words();var t=function(e,t){for(var o=0,n=0;n<e.length;n++)e[n].toLowerCase()===t&&o++;return o}(e,this.keyword.value.toLowerCase()),o=parseFloat((100+(t-e.length)/e.length*100).toFixed(2));return o<1?{score:SeoField.Levels.BAD,reason:SeoField.Reasons.densityFailUnder.replace("{d}",o)}:o<=2.5?{score:SeoField.Levels.GOOD,reason:SeoField.Reasons.densitySuccess.replace("{d}",o)}:o>2.5?{score:SeoField.Levels.OK,reason:SeoField.Reasons.densityOk.replace("{d}",o).replace("{c}",t)}:{score:SeoField.Levels.BAD,reason:SeoField.Reasons.densityFail}},SeoField.prototype.judgeFleschEase=function(){var e=this.content.stats.fleschKincaidReadingEase();return e>=80?{score:SeoField.Levels.GOOD,reason:SeoField.Reasons.fleschSuccess.replace("{l}",e)}:e>=60?{score:SeoField.Levels.OK,reason:SeoField.Reasons.fleschOk.replace("{l}",e)}:{score:SeoField.Levels.BAD,reason:SeoField.Reasons.fleschFail.replace("{l}",e)}},SeoField.Fail=function(e){Craft.cp.displayError("<strong>SEO:</strong> "+e),window.console&&console.error.apply(console,["%cSEO: %c"+e,"font-weight:bold;","font-weight:normal;"])},SeoField.GetEntryHTML=function(){this.clean()},SeoField.GetEntryHTML.prototype.update=function(e){var t=this,o=Garnish.getPostData(document.getElementById("container"));"undefined"!==_typeof(Craft.livePreview)?this.lastPostData&&Craft.compare(o,this.lastPostData)||(this.lastPostData=o,$.ajax({url:Craft.livePreview.previewUrl,method:"POST",data:$.extend({},o,Craft.livePreview.basePostData),xhrFields:{withCredentials:!0},crossDomain:!0,success:function(o){o=o.replace(/<script([^'"]|"(\\.|[^"\\])*"|'(\\.|[^'\\])*')*?<\/script>/g,""),t.iframe.contentWindow.document.open(),t.iframe.contentWindow.document.write(o),t.iframe.contentWindow.document.close(),t.iframe.contentWindow.document.body?e(t.iframe.contentWindow.document.body):SeoField.Fail("Unable to calculate score")}})):this.score.previousElementSibling.classList.add("hide")},SeoField.GetEntryHTML.prototype.clean=function(){this.iframe&&document.body.removeChild(this.iframe),this.iframe=document.createElement("iframe"),this.iframe.setAttribute("frameborder","0"),this.iframe.style.width="0px",this.iframe.style.height="0px",document.body.appendChild(this.iframe)},SeoField.isExternalUrl=function(){var e=/https?:\/\/((?:[\w\d]+\.)+[\w\d]{2,})/i,t=null;return function(o){function n(o){return null!==(t=e.exec(o))&&t[1]}return n(location.href)!==n(o)}}(),SeoField.sortScore=function(e){var t=[],o=[],n=[];for(var s in e)if(e.hasOwnProperty(s)&&e[s])switch(e[s].key=s,e[s].score){case SeoField.Levels.BAD:n.push(e[s]);break;case SeoField.Levels.OK:o.push(e[s]);break;case SeoField.Levels.GOOD:t.push(e[s])}return{good:t,ok:o,bad:n,merged:t.concat(o.concat(n))}},function(e){function t(e){return["li","p","h1","h2","h3","h4","h5","h6","dd"].forEach(function(t){e=e.replace("</"+t+">",".")}),e=e.replace(/<[^>]+>/g,"").replace(/[,:;()-]/," ").replace(/’/g,"'").replace(/[\.!?]/,".").replace(/^\s+/,"").replace(/[ ]*(\n|\r\n|\r)[ ]*/," ").replace(/([\.])[\. ]+/,".").replace(/[ ]*([\.])/,". ").replace(/\s+/," ").replace(/\s+$/,""),e+="."}var o=function(e){this.text=e?t(e):this.text};o.prototype.fleschKincaidReadingEase=function(e){return e=e?t(e):this.text,Math.round(10*(206.835-1.015*this.averageWordsPerSentence(e)-84.6*this.averageSyllablesPerWord(e)))/10},o.prototype.fleschKincaidGradeLevel=function(e){return e=e?t(e):this.text,Math.round(10*(.39*this.averageWordsPerSentence(e)+11.8*this.averageSyllablesPerWord(e)-15.59))/10},o.prototype.gunningFogScore=function(e){return e=e?t(e):this.text,Math.round(.4*(this.averageWordsPerSentence(e)+this.percentageWordsWithThreeSyllables(e,!1))*10)/10},o.prototype.colemanLiauIndex=function(e){return e=e?t(e):this.text,Math.round(10*(this.letterCount(e)/this.wordCount(e)*5.89-this.sentenceCount(e)/this.wordCount(e)*.3-15.8))/10},o.prototype.smogIndex=function(e){return e=e?t(e):this.text,Math.round(1.043*Math.sqrt(this.wordsWithThreeSyllables(e)*(30/this.sentenceCount(e))+3.1291)*10)/10},o.prototype.automatedReadabilityIndex=function(e){return e=e?t(e):this.text,Math.round(10*(this.letterCount(e)/this.wordCount(e)*4.71+this.wordCount(e)/this.sentenceCount(e)*.5-21.43))/10},o.prototype.textLength=function(e){return(e=e?t(e):this.text).length},o.prototype.letterCount=function(e){return(e=(e=e?t(e):this.text).replace(/[^a-z]+/gi,"")).length},o.prototype.sentenceCount=function(e){return(e=e?t(e):this.text).replace(/[^\.!?]/g,"").length||1},o.prototype.wordCount=function(e){return(e=e?t(e):this.text).split(/[^a-z0-9']+/i).length||1},o.prototype.words=function(){return this._words?this._words:this._words=this.text.split(/[^a-z0-9']+/i)},o.prototype.averageWordsPerSentence=function(e){return e=e?t(e):this.text,this.wordCount(e)/this.sentenceCount(e)},o.prototype.averageSyllablesPerWord=function(e){var o=this;e=e?t(e):this.text;var n=0,s=this.wordCount(e);return e.split(/\s+/).forEach(function(e){n+=o.syllableCount(e)}),(n||1)/(s||1)},o.prototype.wordsWithThreeSyllables=function(e,o){var n=this;e=e?t(e):this.text;var s=0;return o=!1!==o,e.split(/\s+/).forEach(function(e){e.match(/^[A-Z]/)&&!o||n.syllableCount(e)>2&&s++}),s},o.prototype.percentageWordsWithThreeSyllables=function(e,o){return e=e?t(e):this.text,this.wordsWithThreeSyllables(e,o)/this.wordCount(e)*100},o.prototype.syllableCount=function(e){var t=0,o=0,n=0;e=e.toLowerCase().replace(/[^a-z]/g,"");var s={simile:3,forever:3,shoreline:2};if(s.hasOwnProperty(e))return s[e];return[/^un/,/^fore/,/ly$/,/less$/,/ful$/,/ers?$/,/ings?$/].forEach(function(t){e.match(t)&&(e=e.replace(t,""),o++)}),n=e.split(/[^aeiouy]+/gi).filter(function(e){return!!e.replace(/\s+/gi,"").length}).length,t=n+o,[/cial/,/tia/,/cius/,/cious/,/giu/,/ion/,/iou/,/sia$/,/[^aeiuoyt]{2,}ed$/,/.ely$/,/[cg]h?e[rsd]?$/,/rved?$/,/[aeiouy][dt]es?$/,/[aeiouy][^aeiouydt]e[rsd]?$/,/^[dr]e[aeiou][^aeiou]+$/,/[aeiouy]rse$/].forEach(function(o){e.match(o)&&t--}),[/ia/,/riet/,/dien/,/iu/,/io/,/ii/,/[aeiouym]bl$/,/[aeiou]{3}/,/^mc/,/ism$/,/([^aeiouy])\1l$/,/[^l]lien/,/^coa[dglx]./,/[^gq]ua[^auieo]/,/dnt$/,/uity$/,/ie(r|st)$/].forEach(function(o){e.match(o)&&t++}),t||1};function n(e){return new o(e)}"undefined"!=typeof module&&module.exports?module.exports=n:"undefined"!=typeof define?define("textstatistics",[],function(){return n}):e.TextStatistics=n}(SeoField),SeoField.Levels={NONE:"",GOOD:"good",OK:"ok",BAD:"bad"},SeoField.Reasons={titleLengthFailMin:"The title contains {l} characters which is less than the recommended minimum of 40 characters.",titleLengthFailMax:"The title contains {l} characters which is greater than the recommended maximum of 60 characters.",titleLengthSuccess:"The title is between the recommended minimum and maximum length.",titleKeywordFail:"The title does not contain the keyword. Try adding it near the beginning of the title.",titleKeywordSuccess:"The title contains the keyword near the beginning.",titleKeywordPosFail:"The title contains the keyword, but not near the beginning. Try to move it closer to the start of the title.",slugFail:"The URL does not contain the keyword. Try adding it to the slug.",slugSuccess:"The URL contains the keyword.",descFail:"The description does not contain the keyword. Try adding it near the beginning of the description.",descSuccess:"The description contains the keyword.",wordCountFail:"Your text contains {l} words, this is less than the recommended 300 word minimum.",wordCountSuccess:"Your text contains {l} words, this is more than the recommended 300 word minimum.",firstParagraphFail:"The keyword does not appear in the first paragraph of your text. Try adding it.",firstParagraphSuccess:"The keyword appears in the first paragraph of your text.",imagesFail:"Less than half of the images have alt tags containing the keyword, try adding it to more images.",imagesOk:"Half or more of the images have alt tags containing the keyword. To improve this, try adding keywords to all the images alt tags.",imagesSuccess:"All of the images have alt tags containing the keyword.",linksFail:"The page does not contain any outgoing links. Try adding some.",linksSuccess:"The page contains outgoing links.",headingsFail:"The page does not contain any headings that contain the keyword. Try adding some with the keyword.",headingsOk:"The page contains some lower importance headings that contain the keyword. Try adding the keyword to some h2's.",headingsSuccess:"The page contains higher importance headings with the keyword.",densityFail:"The keyword does not appear in the text. It is important to include it in your content.",densityFailUnder:"The keyword density is {d}%, which is well under the advised 2.5%. Try increasing the number of times the keyword is used.",densityOk:"The keyword density is {d}%, which is over the advised 2.5%. The keyword appears {c} times.",densitySuccess:"The keyword density is {d}%, which is near the advised 2.5%.",fleschFail:"The Flesch Reading ease score is {l} which is considered best for university graduates. Try reducing your sentence length to improve readability.",fleschOk:"The Flesch Reading ease score is {l} which is average, and considered easily readable by most users.",fleschSuccess:"The Flesch Reading ease score is {l} meaning your content is readable by all ages."};
//# sourceMappingURL=seo-field.min.js.map
